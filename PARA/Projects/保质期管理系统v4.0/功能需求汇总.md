# 保质期管理系统v4.0 - 功能需求汇总

## 项目概述
- **项目名称**：保质期管理系统v4.0
- **部署地址**：http://pandian.dhmip.cn/
- **服务器**：211.154.19.189:21 (FTP)
- **开发语言**：PHP 8.2 + 原生JavaScript
- **前端框架**：Bootstrap 5.3 + jQuery
- **数据库**：MySQL
- **架构**：多页面应用架构（MPA）

---

## 已实现的功能

### 1. 用户认证系统
- **登录页面**：支持用户名/密码登录
- **记住我功能**：7天自动登录
- **权限验证**：基于角色的访问控制（RBAC）
- **会话管理**：30分钟超时
- **密码加密**：bcrypt加密存储

### 2. 核心业务功能

#### 2.1 首页/系统概览
- 系统统计数据展示
- 商品总数、盘点记录、待处理任务等
- 最近操作记录列表
- 快速操作入口

#### 2.2 新增盘点
- 二维码扫描功能（模拟）
- 手动输入SKU
- 商品列表实时显示
- 批次信息输入
- 草稿自动保存功能

#### 2.3 历史盘点查询
- 盘点记录列表
- 状态筛选（全部/草稿/已提交）
- 关键词搜索
- 时间范围筛选
- 分页显示
- 详情查看

#### 2.4 系统管理
- 用户管理（预留）
- 分类管理（预留）
- 参数配置（预留）

### 3. 数据库设计
```
7个核心表：
- pd_users: 用户信息
- pd_categories: 商品分类
- pd_products: 商品信息
- pd_inventory_sessions: 盘点会话
- pd_inventory_entries: 盘点条目
- pd_batches: 商品批次
- pd_logs: 操作日志
```

### 4. API接口
- `/api/login.php` - 用户登录
- `/api/logout.php` - 用户登出
- `/api/overview.php` - 系统概览数据
- `/api/[其他接口待开发]`

---

## 待实现功能

### 1. 数据库连接问题
- 当前状态：连接失败 (`SQLSTATE[HY000] [1045] Access denied for user 'root'@'localhost'`)
- 需要：服务器MySQL用户密码配置

### 2. 页面完善
- **首页图表展示**：统计图表优化
- **历史记录删除/编辑**：编辑和删除功能
- **导出功能**：数据导出到Excel/CSV

### 3. 商品管理
- 商品信息添加/编辑/删除
- 批量导入功能
- 商品分类管理

### 4. 批次管理
- 批次追踪
- 预警通知
- 过期提醒

### 5. 报表统计
- 保质期分析报表
- 盘点趋势分析
- 库存周转率计算

### 6. 系统优化
- 二维码扫描功能完善
- 离线模式支持
- 数据同步功能

---

## 技术架构

### 目录结构
```
保质期管理系统v4.0/
├── install.php                 # 安装引导页
├── index.php                   # 首页重定向
├── install.sql                 # 数据库脚本
├── includes/
│   ├── config.php             # 配置文件
│   ├── db.php                 # 数据库类
│   ├── functions.php          # 工具函数
│   ├── check_auth.php         # 权限检查
│   ├── header.php             # 页面头部
│   └── footer.php             # 页面底部
├── pages/
│   ├── login.php              # 登录页面
│   ├── index.php              # 首页
│   ├── new.php                # 新增盘点
│   └── past.php               # 历史盘点
├── api/
│   ├── login.php              # 登录接口
│   ├── logout.php             # 登出接口
│   └── overview.php           # 概览接口
├── assets/
│   ├── css/                   # 样式文件
│   ├── js/                    # 脚本文件
│   ├── images/                # 图片资源
│   └── lib/                   # 外部库
├── uploads/                   # 上传文件
├── logs/                      # 日志文件
└── backup/                    # 备份文件
```

---

## 服务器信息

### FTP服务器
- **地址**：211.154.19.189:21
- **用户名**：pandian
- **密码**：pandian
- **根路径**：`/` (网站真实根路径)

### 数据库配置
- **默认用户名**：root
- **默认密码**：(未知，需要配置)
- **默认数据库**：pandian

### 运行环境
- **PHP**：8.2
- **MySQL**：运行中
- **Web服务器**：Nginx
- **系统**：宝塔面板管理

---

## 当前问题和待办

### 1. 安装引导页
- 已完成：页面设计和表单布局
- 待完成：数据库连接验证

### 2. 数据库连接
- 当前错误：`SQLSTATE[HY000] [1045] Access denied for user 'root'@'localhost'`
- 需要：服务器MySQL用户权限配置

### 3. 系统功能
- 页面框架已完成
- 数据展示待完善
- API接口需要实现

---

## 开发建议

### 1. 技术方案
- 采用3-Agent工作流（项目经理→开发→审计）
- 使用原生JavaScript，避免引入复杂框架
- 保持架构简单，便于维护

### 2. 开发顺序
1. 先完成数据库连接配置
2. 实现核心API接口
3. 完善页面功能
4. 优化用户体验

---

**最后更新**：2026-02-22
**项目状态**：开发中，框架已搭建，核心功能待实现
**开发语言**：PHP 8.2 + JavaScript
**部署地址**：http://pandian.dhmip.cn/
