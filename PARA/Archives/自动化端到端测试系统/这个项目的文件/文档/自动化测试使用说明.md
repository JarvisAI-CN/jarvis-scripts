# è‡ªåŠ¨åŒ–ç«¯åˆ°ç«¯æµ‹è¯•ç³»ç»Ÿ - ä½¿ç”¨è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬ç³»ç»Ÿæä¾›äº†ä¸¤ä¸ªæ ¸å¿ƒè„šæœ¬æ¥è‡ªåŠ¨åŒ–æµ‹è¯•æ‰§è¡Œå’ŒæŠ¥å‘Šç”Ÿæˆï¼š

1. **run_all_tests.py** - å…¨æµ‹è¯•æ‰§è¡Œå™¨ï¼šè¿è¡Œæ‰€æœ‰æµ‹è¯•å¹¶ä¿å­˜ç»“æœ
2. **auto_reporter.py** - è‡ªåŠ¨æŠ¥å‘Šç”Ÿæˆå™¨ï¼šåˆ†æè¶‹åŠ¿å¹¶ç”ŸæˆMarkdownæŠ¥å‘Š

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# è¿›å…¥ä»£ç ç›®å½•
cd /home/ubuntu/.openclaw/workspace/PARA/Projects/è‡ªåŠ¨åŒ–ç«¯åˆ°ç«¯æµ‹è¯•ç³»ç»Ÿ/è¿™ä¸ªé¡¹ç›®çš„æ–‡ä»¶/ä»£ç 

# è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆé»˜è®¤å¹¶å‘æ‰§è¡Œï¼‰
python3 run_all_tests.py

# é¡ºåºæ‰§è¡Œæµ‹è¯•
python3 run_all_tests.py --sequential

# è‡ªå®šä¹‰å¹¶å‘æ•°
python3 run_all_tests.py --workers 8

# æŸ¥çœ‹å¸®åŠ©
python3 run_all_tests.py --help
```

**æµ‹è¯•ç»“æœå°†è‡ªåŠ¨ä¿å­˜åˆ°**: `ä»£ç /test_results/report_YYYYMMDD_HHMMSS.json`

### 2. ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š

```bash
# ä½¿ç”¨æœ€æ–°çš„æµ‹è¯•ç»“æœç”ŸæˆæŠ¥å‘Š
python3 auto_reporter.py --result test_results/report_20260216_010000.json

# è‡ªå®šä¹‰æŠ¥å‘Šè¾“å‡ºè·¯å¾„
python3 auto_reporter.py --result test_results/report_20260216_010000.json --output ../æ–‡æ¡£/æµ‹è¯•æŠ¥å‘Š_custom.md

# ç¦ç”¨è¶‹åŠ¿åˆ†æ
python3 auto_reporter.py --result test_results/report_20260216_010000.json --no-trend

# è‡ªå®šä¹‰æ€§èƒ½é€€åŒ–é˜ˆå€¼ï¼ˆé»˜è®¤20%ï¼‰
python3 auto_reporter.py --result test_results/report_20260216_010000.json --threshold 30

# æŸ¥çœ‹å¸®åŠ©
python3 auto_reporter.py --help
```

**æŠ¥å‘Šé»˜è®¤ä¿å­˜åˆ°**: `æ–‡æ¡£/æµ‹è¯•æŠ¥å‘Š_latest.md`

---

## ğŸ“Š æµ‹è¯•å¥—ä»¶ç»“æ„

### åŒ…å«çš„æµ‹è¯•ç±»å‹

#### 1. æ€§èƒ½æµ‹è¯• (Performance)
- **ResponseTimeTest**: å“åº”æ—¶é—´æµ‹è¯•
  - éªŒè¯æ“ä½œåœ¨æŒ‡å®šé˜ˆå€¼å†…å®Œæˆ
  - ç¤ºä¾‹: å¿«é€Ÿæ“ä½œåº”åœ¨100mså†…å®Œæˆ

- **ThroughputTest**: ååé‡æµ‹è¯•
  - æµ‹é‡æ¯ç§’äº‹åŠ¡å¤„ç†æ•°(TPS)
  - ç¤ºä¾‹: ç®€å•ä»»åŠ¡åº”è¾¾åˆ°è‡³å°‘10 TPS

- **ResourceUsageTest**: èµ„æºä½¿ç”¨æµ‹è¯•
  - ç›‘æ§CPUå’Œå†…å­˜ä½¿ç”¨æƒ…å†µ
  - ç¤ºä¾‹: CPUä¸è¶…è¿‡80%, å†…å­˜ä¸è¶…è¿‡512MB

#### 2. å®‰å…¨æµ‹è¯• (Security)
- **VulnerabilityScanner**: ä»£ç æ¼æ´æ‰«æ
  - ä½¿ç”¨Banditæ‰«æPythonä»£ç æ¼æ´
  - æ£€æµ‹é«˜å±å®‰å…¨é—®é¢˜

- **ConfigAuditor**: é…ç½®æ–‡ä»¶å®¡è®¡
  - æ£€æŸ¥é…ç½®æ–‡ä»¶å®‰å…¨æ€§
  - éªŒè¯æ•æ„Ÿä¿¡æ¯æœªæš´éœ²

- **PermissionChecker**: æ–‡ä»¶æƒé™æ£€æŸ¥
  - éªŒè¯æ–‡ä»¶æƒé™è®¾ç½®
  - ç¡®ä¿æ²¡æœ‰è¿‡åº¦å®½æ¾çš„æƒé™

#### 3. å›å½’æµ‹è¯• (Regression)
- **FunctionalTest**: åŠŸèƒ½éªŒè¯æµ‹è¯•
  - å‡½æ•°è¾“å‡ºéªŒè¯
  - APIå“åº”éªŒè¯
  - æ–‡ä»¶å†…å®¹éªŒè¯

- **CompatibilityTest**: å…¼å®¹æ€§æµ‹è¯•
  - å¤šé…ç½®éªŒè¯
  - ç¡®ä¿åŠŸèƒ½åœ¨ä¸åŒé…ç½®ä¸‹æ­£å¸¸å·¥ä½œ

---

## ğŸ“ˆ æŠ¥å‘ŠåŠŸèƒ½

### TrendAnalyzer - è¶‹åŠ¿åˆ†æ

è‡ªåŠ¨å¯¹æ¯”å½“å‰æµ‹è¯•ç»“æœä¸å†å²æ•°æ®ï¼š

- âœ… **æ€§èƒ½é€€åŒ–æ£€æµ‹**: è€—æ—¶å¢åŠ  > 20% è§¦å‘è­¦å‘Š
- âœ… **æ€§èƒ½æ”¹è¿›è¯†åˆ«**: è€—æ—¶å‡å°‘ > 20% æ ‡è®°ä¸ºæ”¹è¿›
- âœ… **æˆåŠŸç‡è¶‹åŠ¿**: å¯¹æ¯”å†å²å¹³å‡æˆåŠŸç‡
- âœ… **çŠ¶æ€å˜åŒ–**: è¿½è¸ªæµ‹è¯•ç”¨ä¾‹ä»å¤±è´¥åˆ°é€šè¿‡çš„æ”¹è¿›

### AlertManager - å‘Šè­¦ç®¡ç†

æ™ºèƒ½å‘Šè­¦è§„åˆ™ï¼š

| å‘Šè­¦çº§åˆ« | è§¦å‘æ¡ä»¶ |
|---------|---------|
| ğŸ”´ ä¸¥é‡ | æˆåŠŸç‡ < 50% æˆ–æœ‰æµ‹è¯•é”™è¯¯ |
| âš ï¸ è­¦å‘Š | æˆåŠŸç‡ < 100% æˆ–æ€§èƒ½é€€åŒ– > 20% |
| â„¹ï¸ ä¿¡æ¯ | æˆåŠŸç‡ < 100% ä½† >= 80% |

### MarkdownæŠ¥å‘Šå†…å®¹

ç”Ÿæˆçš„æŠ¥å‘ŠåŒ…å«ï¼š

1. **æ‰§è¡Œæ‘˜è¦**: æ€»ä½“ç»Ÿè®¡å’ŒæˆåŠŸç‡
2. **å‘Šè­¦ä¿¡æ¯**: æŒ‰çº§åˆ«åˆ†ç±»çš„å‘Šè­¦åˆ—è¡¨
3. **è¶‹åŠ¿åˆ†æ**: æ€§èƒ½é€€åŒ–/æ”¹è¿›è¯¦æƒ…
4. **æµ‹è¯•ç”¨ä¾‹è¯¦æƒ…**: æ¯ä¸ªæµ‹è¯•çš„çŠ¶æ€å’Œè€—æ—¶
5. **å¤±è´¥/é”™è¯¯è¯¦æƒ…**: å®Œæ•´çš„é”™è¯¯ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ª

---

## ğŸ”§ é«˜çº§ç”¨æ³•

### ä½œä¸ºPythonæ¨¡å—ä½¿ç”¨

#### run_all_tests.py

```python
from run_all_tests import run_all_tests
from pathlib import Path

# è¿è¡Œæµ‹è¯•
result = run_all_tests(
    parallel=True,
    max_workers=4,
    save_results=True,
    output_dir=Path("custom_results")
)

# è®¿é—®ç»“æœ
print(f"æˆåŠŸç‡: {result.to_dict()['success_rate']}%")
print(f"é€šè¿‡: {result.passed}/{result.total}")
```

#### auto_reporter.py

```python
from auto_reporter import generate_report, FeishuIntegration
import json

# ç”ŸæˆæŠ¥å‘Š
report, metadata = generate_report(
    result_path=Path("test_results/report_20260216_010000.json"),
    enable_trend_analysis=True,
    regression_threshold=20.0
)

print(f"æŠ¥å‘Šå·²ç”Ÿæˆ: {metadata['output_path']}")
print(f"å‘Šè­¦æ•°é‡: {metadata['alerts_count']}")

# é£ä¹¦é›†æˆ
with open("test_results/report_20260216_010000.json") as f:
    result_data = json.load(f)

feishu = FeishuIntegration(result_data)
summary = feishu.send_summary()
print(summary)  # å¯å‘é€åˆ°é£ä¹¦
```

### è‡ªå®šä¹‰æµ‹è¯•ç”¨ä¾‹

```python
from test_framework import TestCase
from run_all_tests import run_all_tests

class MyCustomTest(TestCase):
    def setup(self):
        self.data = prepare_test_data()

    def run_test(self):
        # ä½ çš„æµ‹è¯•é€»è¾‘
        self.assert_true(len(self.data) > 0, "æ•°æ®ä¸åº”ä¸ºç©º")

    def teardown(self):
        cleanup_test_data(self.data)

# æ·»åŠ åˆ°æµ‹è¯•å¥—ä»¶
from regression_test import RegressionSuite

suite = RegressionSuite("CustomSuite")
suite.add_test(MyCustomTest("MyCustomTest"))
result = suite.run()
```

---

## ğŸ“ ç›®å½•ç»“æ„

```
è‡ªåŠ¨åŒ–ç«¯åˆ°ç«¯æµ‹è¯•ç³»ç»Ÿ/
â”œâ”€â”€ è¿™ä¸ªé¡¹ç›®çš„æ–‡ä»¶/
â”‚   â”œâ”€â”€ ä»£ç /
â”‚   â”‚   â”œâ”€â”€ test_framework.py       # æ ¸å¿ƒæµ‹è¯•æ¡†æ¶
â”‚   â”‚   â”œâ”€â”€ performance_test.py     # æ€§èƒ½æµ‹è¯•æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ security_test.py        # å®‰å…¨æµ‹è¯•æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ regression_test.py      # å›å½’æµ‹è¯•æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ run_all_tests.py        # â­ å…¨æµ‹è¯•æ‰§è¡Œå™¨
â”‚   â”‚   â”œâ”€â”€ auto_reporter.py        # â­ è‡ªåŠ¨æŠ¥å‘Šç”Ÿæˆå™¨
â”‚   â”‚   â””â”€â”€ test_results/           # æµ‹è¯•ç»“æœç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â”‚       â””â”€â”€ report_*.json
â”‚   â”œâ”€â”€ æ–‡æ¡£/
â”‚   â”‚   â””â”€â”€ æµ‹è¯•æŠ¥å‘Š_latest.md      # æœ€æ–°æµ‹è¯•æŠ¥å‘Š
â”‚   â””â”€â”€ é…ç½®/
â”‚       â””â”€â”€ test_config.yaml        # æµ‹è¯•é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
```

---

## ğŸ” å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹ï¼Ÿ

A: åœ¨ `run_all_tests.py` çš„ `collect_all_tests()` å‡½æ•°ä¸­æ·»åŠ ï¼š

```python
def collect_all_tests() -> List[TestCase]:
    all_tests = []

    # æ·»åŠ ä½ çš„æµ‹è¯•
    all_tests.append(
        FunctionalTest.verify_function(
            name="MyNewTest",
            func=my_function,
            args=(1, 2),
            expected=3
        )
    )

    return all_tests
```

### Q: å¦‚ä½•ä¿®æ”¹æ€§èƒ½é€€åŒ–é˜ˆå€¼ï¼Ÿ

A: ä½¿ç”¨ `--threshold` å‚æ•°ï¼š

```bash
python3 auto_reporter.py --result test_results/report_latest.json --threshold 30
```

æˆ–åœ¨ä»£ç ä¸­ï¼š

```python
generate_report(
    result_path=...,
    regression_threshold=30.0  # 30% é˜ˆå€¼
)
```

### Q: æµ‹è¯•å¤±è´¥æ—¶å¦‚ä½•æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼Ÿ

A: æŸ¥çœ‹ç”Ÿæˆçš„MarkdownæŠ¥å‘Šçš„"å¤±è´¥/é”™è¯¯è¯¦æƒ…"éƒ¨åˆ†ï¼ŒåŒ…å«ï¼š
- å®Œæ•´çš„é”™è¯¯ä¿¡æ¯
- Pythonå †æ ˆè·Ÿè¸ª
- æ¯ä¸ªæ‰§è¡Œæ­¥éª¤çš„çŠ¶æ€

### Q: å¦‚ä½•é›†æˆåˆ°CI/CDï¼Ÿ

A: æ·»åŠ åˆ°CIè„šæœ¬ï¼š

```bash
#!/bin/bash
set -e

# è¿è¡Œæµ‹è¯•
python3 run_all_tests.py

# è·å–æœ€æ–°çš„ç»“æœ
LATEST_RESULT=$(ls -t test_results/report_*.json | head -1)

# ç”ŸæˆæŠ¥å‘Š
python3 auto_reporter.py --result "$LATEST_RESULT"

# æ£€æŸ¥æˆåŠŸç‡ï¼ˆå¯é€‰ï¼‰
SUCCESS_RATE=$(jq '.success_rate' "$LATEST_RESULT")
if (( $(echo "$SUCCESS_RATE < 100" | bc -l) )); then
    echo "Tests failed!"
    exit 1
fi
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [test_framework.py](../ä»£ç /test_framework.py) - æ ¸å¿ƒæ¡†æ¶æ–‡æ¡£
- [regression_test.py](../ä»£ç /regression_test.py) - å›å½’æµ‹è¯•æ¨¡å—
- [performance_test.py](../ä»£ç /performance_test.py) - æ€§èƒ½æµ‹è¯•æ¨¡å—
- [security_test.py](../ä»£ç /security_test.py) - å®‰å…¨æµ‹è¯•æ¨¡å—

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤é—®é¢˜å’Œæ”¹è¿›å»ºè®®ï¼

---

**ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¶é—´**: 2026-02-16
**ç»´æŠ¤è€…**: è‡ªåŠ¨åŒ–æµ‹è¯•å›¢é˜Ÿ
