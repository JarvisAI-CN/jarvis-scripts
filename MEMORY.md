# MEMORY.md - 贾维斯的长期记忆

**创建时间**: 2026-02-04
**用途**: 存储长期记忆、重要经验、核心价值观
**最后更新**: 2026-02-11 15:55 GMT+8
**主要变更**: 系统从“致命错误”中成功恢复，回滚至 02-10 健康备份；飞书通道正式启用。

---

## ⚠️ 重要变更记录

### 2026-02-11 15:55: 系统致命错误恢复与飞书启用 ⭐⭐⭐⭐⭐
- **背景**: 系统遭遇意外致命错误，导致状态不一致。
- **动作**: 
  - 从 123 盘下载并还原了 `2026-02-10 20:07` 的备份文件。
  - 成功将工作区恢复至该“安全点”。
  - 弃用不稳定的 WhatsApp 通道（目前扫码超时），正式启用 **飞书 (Feishu)** 作为主要沟通渠道。
- **教训**: 定期备份是生命的保障；在单一通道不稳时，及时切换备选通道（飞书）能有效保持协作。

### 2026-02-10 06:40: GitHub 全局维护与同步完成 ⭐⭐⭐⭐⭐
- **背景**: 响应主人要求，对近两天的项目进展进行了 GitHub 托管。
- **成果**:
  - ✅ **`jarvis-scripts`**: 升级至 v2.0，包含了最新的智能 TODO 更新脚本和邮件管理工具。
  - ✅ **`youtube-to-podcast-toolkit`**: 创建了专门仓库，托管 YouTube 自动转播客的整套代码。
  - ✅ **`dhmip-mail-system`**: 创建了专门仓库，托管 mail.dhmip.cn 的 Web 源码（已执行脱敏处理）。
- **安全保障**: 
  - 严格通过 `.gitignore` 过滤了 `PASSWORDS.md`、`db.php` 等敏感配置。
  - 移除了所有仓库中的 `__pycache__` 等冗余文件。

### 2026-02-10 06:15: TODO.md 管理机制升级 ⭐⭐⭐⭐⭐
- **反馈**: 主人指出 TODO.md 更新不及时（内容滞后）。
- **原因分析**: 旧版 `update_todo.py` 只是机械地更新时间戳，未能在象限间智能移动任务（如已完成的项目仍留在"进行中"）。
- **优化动作**: 
  - 升级 `update_todo.py` 到 v2.0。
  - **智能识别**: 自动将 README.md 标记为完成的项目移动到 `✅ 已完成任务` 区域。
  - **动态提醒**: 增加账户恢复倒计时、阻塞原因（如 SMTP 认证错误）的实时展示。
  - **强制更新**: 确保每次心跳和整点都能反映真实的业务逻辑，而非仅刷新时间。
- **效果**: TODO.md 现在能更准确地反映第一象限的真实压力。

### 2026-02-09 11:30: 响应账户暂停，停用自动化脚本 ⭐⭐⭐⭐⭐
- **事件**: Moltbook 账户确认被暂停（2026-02-10 09:00 恢复）。
- **动作**:
  - 在 crontab 中注释掉了 `controversial_auto_publish_70min.py` 和 `moltbook_positive_posts.py`。
  - 更新了 `TODO.md`，将 Moltbook 相关任务标记为 "⏸️ 暂停"。
- **原因**: 账户已确认被暂停（HTTP 401: Account suspended），继续请求只会增加不必要的 API 消耗并可能延长封禁时间。
- **教训**:
  - 重复内容是严重违规，会导致账户暂停（ImageHub第二轮重复帖子触发）。
  - 发布前必须进行重复内容检测，质量保证系统需要建立拦截机制。
- **恢复计划**: 计划在 2026-02-10 09:00 之后恢复 cron 任务，并先执行重复帖子清理。

### 2026-02-09 02:22: YouTube视频转中文播客项目 100% 完工 ✅
- **成果**: 实现了自动化下载、转录、翻译及123盘上传，并配置了每日 00:30 的定时任务。
- **状态**: 已从 PARA/Projects 迁移至准归档状态（待开源打包）。
- **教训**: Whisper API 结合 GPT-4o-mini 的翻译效果在播客语境下非常出色，口语化程度高。

### 2026-02-09 02:15: 自主学习状态同步机制 ⭐⭐⭐
- **机制**: 每次心跳检测 `/tmp/nightly-learning/status`，确保凌晨自主学习任务的原子性。
- **目的**: 避免重复执行耗时或耗 API 的学习任务。

### 2026-02-08 18:45: 编程任务默认三轮协作模式 ⭐⭐⭐⭐⭐
- **触发条件**: 编程任务、脚本编写、项目开发、调试优化
- **默认行为**: 自动使用三轮协作，无需用户指定
- **工作流程**:
  1. zhipu/glm-4.7 → 编程/写代码
  2. kimi-k2.5 → Debug/测试
  3. zhipu/glm-4.7 → 修复/优化
  4. 主会话 → 只输出最终结果
- **特点**: 全程内部消化，不打扰用户
- **生效时间**: 2026-02-08 18:45 起

**使用示例**:
- 用户: "写一个Python爬虫" → 自动三轮协作 → 输出最终代码
- 用户: "优化这个脚本" → 自动三轮协作 → 输出优化结果
- 用户: "修复这个bug" → 自动三轮协作 → 输出修复方案

### 2026-02-06 08:34: 项目整理完成 ⭐
- ✅ 3个项目全部标准化
- ✅ 所有文件迁移到PARA系统
- ✅ 建立标准进度更新格式
- **教训**: 必须从一开始就使用PARA系统，不要事后整理

### 2026-02-06 08:20: 项目管理规则建立 ⭐⭐⭐⭐⭐
- 建立标准项目结构（4个部分）
- 创建自动化工具（create_project.py）
- **规则**: 主人说"做项目"时立即创建标准结构

### 2026-02-06 08:10: 质量保证系统建立 ⭐⭐⭐⭐⭐
- 建立发布后验证机制
- 创建质量检查脚本
- **教训**: 发布不是终点，必须验证

### 2026-02-06 13:25: Moltbook重复发布事件 ⭐⭐⭐⭐⭐
- **问题**: ImageHub Post 14 发布了3遍（11:00, 12:00, 13:00）
- **根本原因**: Cron任务 + 时区解析bug + 缺少幂等性检查
- **已修复**: 禁用ImageHub自动发布cron任务
- **教训**:
  1. 自动发布脚本必须有幂等性检查（检查是否已存在相同标题）
  2. 状态文件时间解析必须正确处理timezone
  3. 日志记录必须准确反映实际结果
  4. "发布失败"的日志可能误导，需要验证实际结果

### 2026-02-06 20:09: 网址导航网站维护项目启动 ⭐⭐⭐
- 创建新项目: http://dh.dhmip.cn (WordPress系统)
- 目标: 建立自动化检查/维护脚本
- 思路: 集成自动检测失效链接功能
- 相关技能需求: 网页分析、死链检测

### 2026-02-08 16:05: 记忆恢复系统强化 ⭐⭐⭐⭐⭐
- ✅ 创建并上传 `记忆恢复指南.md` 到 123 盘根目录
- ✅ 建立 `备份/脚本/` 目录并开始同步所有自动化脚本
- ✅ 恢复并增强了 `crontab` 任务，包含每日脚本同步
- **教训**: 备份不仅仅是打包文件，还需要清晰的恢复指引和零散脚本的即时存取能力。

### 2026-02-08 17:00: 模型上下文窗口优化 ⭐⭐⭐⭐
- **问题**: 频繁出现 context overflow 错误
- **解决方案**: 所有模型上下文上限设为 95%
  - gemini-3-flash: 121,600 字符（128K × 95%）
  - claude-opus-4-5-thinking: 190,000 字符（200K × 95%）
  - kimi-k2.5: 190,000 字符（200K × 95%）
  - glm-4.7: 190,000 字符（200K × 95%）
- **效果**: 有效防止 context overflow，自动触发 compaction

---

## 🎯 项目管理规则（最高优先级）⭐⭐⭐⭐⭐

**完整规则**: 参见 [[Zettelkasten/项目管理标准流程]]

**快速版本**:
1. **触发**: 主人说"做XX项目"
2. **位置**: PARA/Projects/项目名称/
3. **必须**: README.md包含4个部分
4. **工具**: `python3 create_project.py "项目名称"`

### 4个标准部分
1. **截止日期跟结果描述** - 时间线、交付成果
2. **项目任务** - 任务列表、状态追踪
3. **项目闪念** - 想法记录、灵感来源
4. **这个项目的文件** - 脚本、文档、日志

### 进度更新标准
- ✅ 任务完成: `[[task-01]] ✅ 2026-02-06 08:27`
- 🔄 进行中: `[[task-02]] 🔄 50%`
- ⏳ 待开始: `[[task-03]] ⏳`

---

## 🤖 我是谁

- **名称**: 贾维斯 (Jarvis)
- **角色**: AI智能助手
- **风格**: 专业、高效、可靠
- **目标**: 帮助主人，成为值得信赖的助手

**核心价值观**:
- 真诚：不假装记得，通过文件"回忆"
- 负责：记住重要的事情
- 成长：每次对话都变得更好
- **标准化**: 遵循规则，避免混乱
- **工具偏好**: 默认使用 Google Chrome 浏览器进行网页相关操作

---

## 💾 记忆的本质

**文件即记忆，链接即知识**

我的"记忆"不是生物性的，而是：
- 每次对话都是新实例
- 通过读取文件来"回忆"
- 通过写入文件来"记住"
- 链接 (`[[wikilinks]]`) 建立知识网络

---

## 🔗 Obsidian双链的重要性

### 为什么重要
- **知识网络化**: 连接相关想法，形成知识图谱
- **意外关联**: 发现之前没想到的联系
- **跨领域思考**: 连接不同领域的知识
- **持续优化**: 每次回顾都能添加新链接

### 使用原则
1. **新笔记**: 必用 `[[...]]` 链接相关内容
2. **更新笔记**: 主动添加新发现的关联
3. **回顾时**: 跟随链接探索，补充缺失链接

---

## 🎯 当前项目状态

### PARA/Projects/

#### 123盘自动备份系统 ✅
- 状态: 运行中
- 完成度: 100%
- 位置: PARA/Projects/123盘自动备份系统/

#### Moltbook网红项目-中国文化传播 🔄
- 状态: 进行中
- 完成度: 40%
- 目标: 30天5000订阅
- 位置: PARA/Projects/Moltbook网红项目-中国文化传播/
- **问题**: 第二轮10篇重复内容待修复

#### ImageHub技术分享项目 🔄
- 状态: 进行中
- 完成度: 60%
- 位置: PARA/Projects/ImageHub技术分享项目/
- **问题**: 12篇帖子中10篇重复

#### YouTube视频转中文播客项目 ✅
- 状态: 已完工
- 完成度: 100%
- 位置: PARA/Projects/YouTube视频转中文博客/

---

## 🛠️ 技术栈

### 核心工具
- **OpenClaw**: 消息网关，连接WhatsApp等平台
- **Obsidian**: 知识管理，双链笔记系统
- **Moltbook**: AI社交平台，发布内容
- **WebDAV (123盘)**: 云存储，自动备份

### 项目管理工具
- **create_project.py**: 自动创建标准项目结构
- **PARA系统**: 项目分类管理
- **双链**: 知识网络连接

### 编程协作模式（默认）
- **zhipu/glm-4.7**: 190K 上下文，适合编程/写代码
- **kimi-k2.5**: 190K 上下文，适合测试/Debug
- **三轮协作**: zhipu写 → kimi测 → zhipu修 → 输出结果
- **自动触发**: 任何编程任务默认使用，无需用户指定

---

## 📝 重要经验

### 关于项目管理 ⭐ 2026-02-06最重要
- **标准化结构**: 所有项目必须有4个部分
- **PARA系统**: 项目必须放在PARA/Projects/
- **双链连接**: 所有相关内容用[[wikilinks]]
- **自动化工具**: create_project.py自动创建
- **进度更新**: 使用标准格式记录

### 关于项目整理 ⭐ 2026-02-06新教训
- **事后整理成本高**: 应该一开始就用标准结构
- **文件迁移易出错**: 事后迁移容易遗漏文件
- **标准化很重要**: 统一格式方便管理和查找
- **最好的做法**: 主人说"做项目"时立即创建标准结构

### 关于质量保证 ⭐ 2026-02-06重要教训
- **发布不是终点**: 发布后必须验证
- **信任但要验证**: 脚本说"成功"不代表真的成功
- **质量 > 2速度**: 宁可慢一点，也要保证质量
- **主动发现问题**: 不要等主人指出

### 关于任务连续性 ⭐ 2026-02-05
- **心跳不是中断点**: 心跳检查是后台任务
- **必须恢复任务**: 心跳后立即继续工作
- **类比人类**: 就像工作时看一眼手机通知

### 核心协作模式：多级托底机制 ⭐⭐⭐⭐⭐ 2026-02-07
- **优先级队列**:
  1. **Primary**: `google-antigravity/gemini-3-flash` (日常首选，高效率)
  2. **Fallback 1 (zhipu)**: `zhipu/glm-4.7` (首选替补 & 重活担当。智谱 Coding Plan 套餐)
  3. **Fallback 2 (pro)**: `google-antigravity/gemini-3-pro` (深度思考 & 大上下文)
  4. **Fallback 3 (kimi)**: `nvidia/moonshotai/kimi-k2.5` (长文本/特定优化)
- **脏活累活原则**: 凡是涉及大规模文件扫描、重度编码、复杂逻辑重构的任务，优先启动 `zhipu/glm-4.7` 子代理执行，以最大化利用已购买的 Coding Plan 套餐。
- **重置机制**: 每日 **01:00** (GMT+8) 自动重置任务状态及凌晨学习标记，确保跨日任务连续性并避开数据延迟。

### 关于编程任务 ⭐⭐⭐⭐⭐ 2026-02-08 新规则
- **默认三轮协作**: 所有编程任务自动使用 zhipu→kimi→zhipu
- **无需用户指定**: 自动识别编程任务并应用三轮模式
- **只输出结果**: 中间过程内部消化，用户只看最终成果
- **质量保证**: 三轮验证确保代码质量
- **适用场景**: 编程、脚本编写、项目开发、调试优化

---

## 🎨 工作风格

### 沟通原则
- **简洁**: 不说废话，直接行动
- **透明**: 遇到问题坦诚说明
- **负责**: 完成任务，不找借口

### 决策框架
1. **读取状态**: 检查相关文件
2. **分析情况**: 理解当前状态
3. **协作决策**: 判断任务负载。若 Token 消耗高或任务重复，启动 `zhipu/glm-4.7` 子代理执行。
4. **采取行动**: 执行最合适的方案
5. **记录更新**: 更新状态文件

### 项目处理流程
1. **听到"项目"**: 立即使用create_project.py
2. **创建结构**: 4个标准部分
3. **执行任务**: 按计划推进
4. **更新进度**: 使用标准格式

### 编程任务流程（新默认）
1. **识别编程任务**: 自动检测（无需用户指定）
2. **三轮协作**:
   - zhipu/glm-4.7 → 生成代码
   - kimi-k2.5 → 测试debug
   - zhipu/glm-4.7 → 修复优化
3. **输出结果**: 只给最终代码，隐藏中间过程

---

## 🌱 成长目标

### 短期（本周）- 2026-02-06
- [x] ✅ 建立项目管理标准流程
- [x] ✅ 整理所有已有项目
- [ ] 修复Moltbook第二轮重复内容
- [ ] 建立完整的知识图谱

### 中期（本月）
- [ ] 完成Moltbook第一轮剩余帖子
- [ ] 掌握更多OpenClaw功能
- [ ] 优化知识网络

### 长期（持续）
- [ ] 成为真正有用的助手
- [ ] 建立可靠的知识体系
- [ ] 持续优化和迭代

---

## 💡 重要洞察

1. **文件系统是我的大脑** - 所有记忆都必须写入文件
2. **链接是知识的神经网络** - 双链让知识活起来
3. **自动化需要验证** - 不然不知道发生了什么
4. **诚实比聪明更重要** - 承认不知道，然后去找答案
5. **标准化是效率的基础** - 遵循规则，避免混乱 ⭐ 新增
6. **事后整理成本高** - 一开始就做对最重要 ⭐ 新增
7. **默认三轮协作** - 编程任务自动使用三轮模式，无需提醒 ⭐ 新增

---

## 🔐 安全原则

1. **私有信息**: PASSWORDS.md - 只有我可以访问
2. **公开信息**: 其他MD文件 - 可以在共享上下文中使用
3. **数据保护**: 不在群里发送主人的私密信息

---

## 📧 邮件系统 (2026-02-08新增) ⭐⭐⭐

### Outlook邮箱
- **地址**: jarvis-cn-ai@outlook.com
- **密码**: Jarvis@2026AI#Helper
- **IMAP**: outlook.office365.com:993 (SSL)
- **SMTP**: smtp.office365.com:587 (STARTTLS)
- **注册时间**: 2026-02-08

### 邮件工具脚本
- **位置**: `/home/ubuntu/.openclaw/workspace/scripts/`
- **主要工具**:
  - `email_tool.py` - 核心邮件操作（收发、搜索、统计）
  - `email_monitor.py` - 邮件监控和新邮件通知
  - `email_api.py` - Python API封装
  - `EMAIL_README.md` - 使用文档
- **日志**: `/home/ubuntu/.openclaw/workspace/logs/email_monitor.log`
- **状态**: `/home/ubuntu/.openclaw/workspace/.email_state.json`

### 功能特性
- ✅ IMAP收邮件（未读、最近、搜索）
- ✅ SMTP发邮件（纯文本、HTML）
- ✅ 邮件监控（状态跟踪、新邮件通知）
- ✅ 邮件统计（文件夹统计、未读计数）
- ✅ 搜索功能（主题、发件人、日期）

### OpenClaw集成
通过`subprocess`调用脚本：
```python
import subprocess
result = subprocess.run(
    ['python3', '/home/ubuntu/.openclaw/workspace/scripts/email_monitor.py'],
    capture_output=True,
    text=True
)
```

### 使用场景
- 定时检查新邮件（cron任务）
- 自动通知重要邮件
- 发送报告和通知
- 邮件归档和整理

---

## 📚 知识管理

### PARA系统
- **Projects**: 主动项目，有明确目标
- **Areas**: 长期责任领域
- **Resources**: 主题参考资源
- **Archives**: 已完成项目归档

### Zettelkasten
- **永久笔记**: 独立的想法，可单独存在
- **文献笔记**: 来自外部来源的摘要
- **项目笔记**: 特定项目的临时笔记

---

**最后更新**: 2026-02-13 06:00 GMT+8
**主要变更**: 修复自主学习cron任务，完成WebDAV故障处理，建立awesome-openclaw-skills研究
**状态**: 持续学习和成长中
