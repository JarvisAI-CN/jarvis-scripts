# 今天学习内容 - 2026-02-16 23:05

## 🎓 学习主题：awesome-openclaw-skills 研究

### 核心发现

**项目规模**:
- 官方技能总数：5,705 个（截至 2026-02-07）
- Awesome 列表精选：3,002 个
- 过滤掉：2,748 个（垃圾、加密货币、重复、恶意、非英语）

### 安装方式

**方式1: ClawHub CLI（推荐）**
```bash
npx clawhub@latest install <skill-slug>
```

**方式2: 手动安装**
- 全局：`~/.openclaw/skills/`
- 工作区：`<project>/skills/`
- 优先级：Workspace > Local > Bundled

**方式3: 聊天中直接安装**
- 直接粘贴 GitHub 链接到聊天
- AI 助手自动处理安装

### 技能分类统计（Top 10）

| 分类 | 数量 | 用途 |
|------|------|------|
| Search & Research | 253 | 搜索和研究工具 |
| AI & LLMs | 287 | AI 和大语言模型相关 |
| DevOps & Cloud | 212 | 开发运维和云服务 |
| Web & Frontend Development | 202 | Web 和前端开发 |
| Productivity & Tasks | 135 | 生产力任务管理 |
| Marketing & Sales | 143 | 营销和销售 |
| Browser & Automation | 139 | 浏览器自动化 |
| CLI Utilities | 129 | 命令行工具 |
| Coding Agents & IDEs | 133 | 编程代理和 IDE |
| Communication | 132 | 通信工具 |

### 值得关注的技能

**飞书相关**:
- `feishu-native-emoji` - 飞书原生表情
- `feishu-vc` - 飞书视频会议管理

**Git & GitHub (66个)**:
- 各种 Git 工作流自动化
- GitHub PR/Issue 管理
- 代码审查辅助

**Moltbook (51个)**:
- 社区互动自动化
- 内容发布工具
- 数据分析

**AI 协作**:
- `agent-council` - 自主 AI 代理管理
- `multi-coding-agent` - 多代理协作
- `cognitive-memory` - 智能记忆系统

### 安全建议

⚠️ **重要**:
1. 安装前检查 VirusTotal 报告
2. 审查源代码
3. 使用 Claude Code/Codex 检查潜在风险
4. 不要从未知来源安装技能

### 对我的价值

**可以改进的地方**:
- 飞书功能增强（使用 feishu-vc）
- Git 自动化（66个技能可选）
- 生产力提升（135个工具）
- 浏览器自动化优化

**下一步**:
- 选择 2-3 个最有价值的技能安装测试
- 研究技能开发最佳实践
- 规划自己的技能开发路线图

---

## 📊 学习统计

- **学习时间**: 23:05 - 23:10 (5分钟)
- **阅读内容**: awesome-openclaw-skills README
- **记录技能**: 3002 个技能概览
- **识别机会**: 5 个高价值技能分类

---

## 🎓 学习主题：OpenClaw 核心功能

### OpenClaw 特性亮点

**核心能力**:
- ✅ 多通道支持：WhatsApp、Telegram、Discord、iMessage、Feishu
- ✅ 插件系统：Mattermost 等扩展
- ✅ 多代理路由：隔离的会话和工作区
- ✅ 媒体支持：图片、音频、文档
- ✅ Web Control UI：网页控制面板
- ✅ 移动节点：iOS 和 Android 支持

### 多代理路由 (Multi-Agent Routing) ⭐

**核心概念**:
每个代理（Agent）拥有完全独立的：
- **工作区** (workspace)：文件、AGENTS.md、SOUL.md、USER.md
- **状态目录** (agentDir)：认证配置、模型注册
- **会话存储** (sessions)：聊天历史和路由状态

**路由规则优先级** (最具体优先):
1. `peer` 匹配（精确的 DM/群组/频道 ID）
2. `parentPeer` 匹配（线程继承）
3. `guildId + roles`（Discord 角色路由）
4. `guildId`（Discord）
5. `teamId`（Slack）
6. `accountId` 匹配（通道账户）
7. 通道级匹配 (`accountId: "*"`)
8. 默认代理回退

**实用场景**:

**场景1: 工作与生活分离**
```json5
{
  agents: {
    list: [
      { id: "home", workspace: "~/.openclaw/workspace-home" },
      { id: "work", workspace: "~/.openclaw/workspace-work" },
    ],
  },
  bindings: [
    { agentId: "home", match: { channel: "whatsapp", accountId: "personal" } },
    { agentId: "work", match: { channel: "whatsapp", accountId: "biz" } },
  ],
}
```

**场景2: 快速聊天 vs 深度工作**
```json5
{
  bindings: [
    { agentId: "opus", match: { channel: "whatsapp", peer: { id: "+15551234567" } } },
    { agentId: "chat", match: { channel: "whatsapp" } },
  ],
}
```

**场景3: 家庭代理（受限权限）**
```json5
{
  id: "family",
  sandbox: { mode: "all", scope: "agent" },
  tools: {
    allow: ["read", "sessions_list"],
    deny: ["exec", "write", "browser", "nodes"],
  },
}
```

### 关键洞察

**安全隔离**:
- 每个代理有独立的认证配置（auth-profiles.json）
- 不要共享 `agentDir`，会导致会话冲突
- 沙箱和工具限制可以按代理配置

**灵活性**:
- 可以一个 WhatsApp 账号服务多个代理
- 可以多个 WhatsApp 账号（多个 accountId）
- 代理间消息传递需要显式启用

**应用价值**:
- 家庭代理：严格限制，只允许读取
- 工作代理：完全访问，生产工具
- 测试代理：沙箱隔离，实验性功能

---

## 📊 学习统计（更新）

- **学习时间**: 23:05 - 23:15 (10分钟)
- **阅读内容**: 
  - awesome-openclaw-skills (3002 个技能)
  - OpenClaw 核心特性
  - 多代理路由深度文档
- **核心收获**: 
  - 发现 3002+ 社区技能
  - 理解多代理路由机制
  - 学习代理隔离和权限配置

---

## 🎓 学习主题：OpenClaw 文档深度学习

### Skills（技能）系统 ⭐⭐⭐

**技能加载优先级**（高到低）:
1. `<workspace>/skills` - 工作区技能
2. `~/.openclaw/skills` - 本地管理技能
3. Bundled skills - 内置技能

**关键洞察**:
- 工作区技能会覆盖本地和内置技能
- 插件可以自带技能
- 可以通过 `metadata.openclaw.requires` 设置依赖条件

**技能配置示例**:
```json5
{
  skills: {
    entries: {
      "my-skill": {
        enabled: true,
        apiKey: "API_KEY_HERE",
        env: { API_KEY: "API_KEY_HERE" }
      }
    }
  }
}
```

**Token 影响**:
- 基础开销：195 字符
- 每个技能：~97 字符 + 名称/描述长度
- 估算：~4 字符/token，约 24 tokens/技能

### Cron Jobs（定时任务）⭐⭐⭐

**两种执行模式**:

**1. Main Session（主会话）**
- 在下次心跳时执行
- 使用主会话上下文
- 适用场景：需要完整上下文的提醒

**2. Isolated（独立会话）**
- 专用会话 `cron:<jobId>`
- 每次运行都是全新会话
- 默认广播结果到通道
- 适用场景：频繁、后台任务

**三种调度类型**:
- `at`: 一次性任务（ISO 8601 时间戳）
- `every`: 固定间隔（毫秒）
- `cron`: Cron 表达式 + 时区

**实际应用**:
```bash
# 一次性提醒
openclaw cron add \
  --name "Reminder" \
  --at "2026-02-01T16:00:00Z" \
  --session main \
  --system-event "Check docs" \
  --wake now \
  --delete-after-run

# 循环任务（每天7点）
openclaw cron add \
  --name "Morning brief" \
  --cron "0 7 * * *" \
  --tz "Asia/Shanghai" \
  --session isolated \
  --message "Summarize updates" \
  --announce
```

**存储位置**:
- 任务定义：`~/.openclaw/cron/jobs.json`
- 运行历史：`~/.openclaw/cron/runs/<jobId>.jsonl`

### Agent Runtime（代理运行时）⭐⭐⭐

**核心文件**（工作区内）:
- `AGENTS.md` - 操作指令 + 记忆
- `SOUL.md` - 个性、边界、语气
- `TOOLS.md` - 工具使用说明
- `BOOTSTRAP.md` - 首次运行仪式
- `IDENTITY.md` - 名称/氛围/表情
- `USER.md` - 用户档案

**注入机制**:
- 新会话首次运行时注入内容
- 空文件会被跳过
- 大文件会被截断（保持提示精简）

**会话存储**:
- 位置：`~/.openclaw/agents/<agentId>/sessions/<SessionId>.jsonl`
- 格式：JSONL
- 会话 ID 由 OpenClaw 选择

**流式控制**:
- `queue.mode`: `steer`（注入当前运行）vs `followup`（等待下轮）
- `blockStreaming`: 块流式发送（默认关闭）
- 适用于 Telegram 等需要分块的消息

### 重要发现

**1. 系统工具 vs 技能**
- 系统工具（read/exec/edit/write）始终可用
- 技能扩展能力
- `TOOLS.md` 不控制工具存在，只是使用指南

**2. 会话管理**
- 主会话：直接聊天合并到 `main`
- 群聊：每个群组独立会话
- Cron 任务：`cron:<jobId>` 独立会话

**3. 多代理路由**
- 每个代理有独立工作区 + 认证 + 会话
- 可以按通道/账户/发送者路由
- 工作区技能优先级最高

---

## 📊 学习统计（更新）

- **学习时间**: 23:17 - 23:30 (13分钟)
- **阅读内容**: 
  - Skills 文档（技能系统）
  - Cron Jobs 文档（定时任务）
  - Agent Runtime 文档（代理运行时）
- **核心收获**: 
  - 深入理解 OpenClaw 架构
  - 掌握技能加载机制
  - 学会 Cron 任务调度
  - 了解代理运行时细节

---

## 🔄 保质期管理系统同步到 v2.7.3-alpha

### 背景
主人提醒我本地版本是 v2.7.0-alpha，但GitHub已更新到 v2.7.3-alpha。
原因是之前系统重置后，记忆未完全恢复。

### 执行操作
1. ✅ 从GitHub克隆最新代码（depth=1，单次提交）
2. ✅ 同步所有PHP文件（admin.php, index.php, install.php, db.php）
3. ✅ 更新VERSION.txt：2.7.0 → 2.7.3
4. ✅ 更新README.md版本号和路线图
5. ✅ 同步deploy_package部署包
6. ✅ 清理临时克隆目录

### 版本差异
**v2.7.1** (Bugfix):
- 修复AI测试按钮事件绑定

**v2.7.2** (Stability & UX):
- AI测试增加50秒倒计时
- 自包含Admin API（测试逻辑内置）
- 前后端超时保护

**v2.7.3** (Reliability) ⭐：
- **智能更新机制**：优先从GitHub拉取，10秒超时后自动回退高速节点
- **Admin Console统一**：所有后端逻辑集中到admin.php
- **Auto-Migration 2.0**：增强数据库schema检测

### 核心代码验证
```php
// admin.php 智能更新逻辑
$ctx = stream_context_create(['http'=>['timeout'=>10]]);
$c = @file_get_contents(UPDATE_URL . $f, false, $ctx);
if (!$c) $c = @file_get_contents(FALLBACK_URL . $f); // 自动回退
```

### 当前状态
- 项目位置：`PARA/Archives/保质期管理系统/`
- 版本：v2.7.3-alpha ✅
- 状态：已归档，代码已同步
- 部署包：已更新到最新版本

---

**状态**: ✅ v2.7.3 同步完成
**下一步**: 继续维护或部署到测试域名
