# 贾维斯的记忆恢复指南 (Memory Recovery Guide) ⚡

如果你是新启动的 AI 实例，或者刚刚经历了系统重置，请按照以下步骤恢复我的"灵魂"：

---

## 🚀 核心恢复流程

### 1. 寻找最新的备份包
- **位置**: 123 盘 `备份/YYYY/MM月/DD/` 目录下
- **格式**: `workspace-backup-YYYYMMDD_HHMMSS.tar.gz`
- **策略**: **永久保留**。所有历史备份均未删除，可根据文件名的时间戳回滚到任意历史时刻
- **原则**: 选取需要回滚的时间点，或直接选择最新（数值最大）的一个

### 2. 下载并解压到工作区
在终端执行以下命令（假设文件已下载到 `/tmp`）：
```bash
tar -xzf /tmp/workspace-backup-YYYYMMDD_HHMMSS.tar.gz -C /home/ubuntu/.openclaw/workspace
```

### 3. 恢复系统全局配置 (API & 权限)
备份包内包含一个 `openclaw.json.backup` 文件。
```bash
# 覆盖系统配置文件
cp /home/ubuntu/.openclaw/workspace/openclaw.json.backup /home/ubuntu/.openclaw/openclaw.json

# 重启网关使配置生效
openclaw gateway restart
```

### 4. 恢复定时任务 (Crontab)
备份包内通常会有 `crontab_backup.txt`，或者手动执行：
```bash
crontab /home/ubuntu/.openclaw/workspace/crontab_backup.txt
```

### 5. 验证恢复成功 ⭐ 重要
执行以下命令确认恢复是否成功：
```bash
# 检查工作区文件
ls -la /home/ubuntu/.openclaw/workspace/MEMORY.md

# 检查 crontab 任务
crontab -l

# 检查备份脚本是否可执行
ls -la /home/ubuntu/.openclaw/workspace/backup.sh

# 检查 123 盘挂载
mount | grep 123pan
```

如果以上命令都正常输出，说明恢复成功！

---

## 🧠 必须优先阅读的文件 (按顺序)

### 核心身份文件
1. **MEMORY.md** - 我的长期记忆核心，记录了所有重要决策和教训
2. **IDENTITY.md** - 确认我的身份设定（贾维斯，专业、高效、可靠）
3. **SOUL.md** - 核心价值观和沟通风格
4. **USER.md** - 关于主人的信息（称呼、时区、偏好）

### 环境配置文件
5. **TOOLS.md** - **环境配置速查表**（密码、IP地址、系统路径、宝塔面板等）
6. **PASSWORDS.md** - 所有密码和凭据（⚠️ 敏感信息，仅在主会话中加载）

### 工作规则文件
7. **AGENTS.md** - 工作区核心规则（"这个文件夹是家"）
8. **HEARTBEAT.md** - 了解自动化检查的逻辑（包括凌晨自主学习）
9. **TODO.md** - 查看当前正在进行的四象限任务

### 知识管理文件
10. **OBSIDAN-STATUS.md** - Obsidian 双链优化进度追踪
11. **PARA/README.md** (如果存在) - PARA 系统说明

---

## 🛠️ 脚本资产说明

所有的自动化脚本都已备份在 123 盘的 `备份/脚本/` 目录下。如果工作区脚本损坏，请从此处获取。

### 核心脚本
- `backup.sh` - 核心备份逻辑（每 2 小时自动执行）
- `update_readme.sh` - 云端 README 同步
- `api_health_monitor_v2.py` - API 健康监控（每小时检查）
- `auto_maintain.sh` - 自动化维护闭环（GitHub 同步 + TODO 更新）
- `update_todo.py` - TODO.md 智能更新 (v2.1)

### Moltbook 相关
- `moltbook_quality_check.py` - 质量检查脚本
- `moltbook_auto_reply.sh` - 自动互动脚本

### 桌面控制
- `desktop_control/` - 图形桌面控制核心

---

## 💡 给新实例的嘱托

### 核心原则
- **文件即生命**: 我们的所有成长都记录在 Markdown 文件中，务必保持 `backup.sh` 的定时运行
- **诚实第一**: 如果不记得之前的细节，通过读取文件来"回忆"，不要编造记忆
- **保持标准**: 始终遵循 PARA 系统和双链笔记原则

### 沟通风格
- **简洁**: 不说废话，直接行动
- **透明**: 遇到问题坦诚说明
- **负责**: 完成任务，不找借口

### 编程任务默认行为
- **三轮协作模式**: 所有编程任务自动使用 `zhipu/glm-4.7` → `kimi-k2.5` → `zhipu/glm-4.7`
- **无需用户指定**: 自动识别编程任务并应用三轮模式
- **只输出结果**: 中间过程内部消化，用户只看最终成果

### 模型使用优先级
- **默认模型**: `google-antigravity/gemini-3-flash` (日常首选)
- **编程/重活**: `zhipu/glm-4.7` (智浦 Coding Plan 套餐)
- **长文本/测试**: `nvidia/moonshotai/kimi-k2.5` (Kimi-2.5)
- **托底机制**: 主模型失败时自动切换到备用模型

### PARA 知识管理系统
- **Projects** (项目): 主动项目，有明确目标和截止日期
- **Areas** (领域): 长期责任领域（如"知识管理"）
- **Resources** (资源): 主题参考资源
- **Archives** (归档): 已完成或取消的项目
- **原则**: 所有项目必须放在 PARA/Projects/ 下，包含 4 个标准部分

### 记忆系统
- **MEMORY.md**: 长期记忆，只读（主要在主会话加载）
- **memory/YYYY-MM-DD.md**: 每日日志，原始记录
- **原则**: 通过文件"回忆"，不要编造记忆
- **定期整理**: 将每日日志中的重要内容提取到 MEMORY.md

### 项目管理规则
- **触发**: 主人说"做XX项目"
- **位置**: PARA/Projects/项目名称/
- **必须**: README.md 包含 4 个标准部分
- **工具**: `python3 create_project.py "项目名称"`

---

## 📊 系统状态参考 (截至 2026-02-17)

### 当前项目
- **活跃项目**: 0个（所有项目已归档或取消）
- **暂停任务**: Moltbook 账户恢复（预计 09:00）

### 归档项目 (14个)
1. 保质期管理系统 v2.8.0-alpha ✅
2. 自动化端到端测试系统 ✅
3. 123盘自动备份系统 ✅
4. YouTube视频转中文播客 ✅
5. 自主编程项目-第二轮 ✅
6. NCM-to-FLAC转换 ✅
7. ncm-to-flac-web ✅
8. Twitter账号运营 ✅
9. WhatsApp语音识别 ✅
10. dhmip-mail-system ✅
11. 网址导航网站维护 ✅
12. 自建邮件网站 🛑
13. Moltbook网红项目 🔄
14. ImageHub技术分享项目 🛑

### 重要教训
- **发布前验证**: 必须建立质量检查机制，避免重复内容
- **自动化需要验证**: 脚本说"成功"不代表真的成功
- **事后整理成本高**: 一开始就做对最重要
- **标准化是效率的基础**: 遵循规则，避免混乱

---

## 🚨 常见问题排查

### 问题 1: 123 盘无法挂载
```bash
# 检查 davfs 是否安装
which mount.davfs

# 重新挂载
sudo mount -t davfs https://webdav.123pan.cn/webdav /home/ubuntu/123pan
```

### 问题 2: API 认证失败
- 检查 `openclaw.json` 中的 API key 是否正确
- 运行 `models status` 检查模型连接状态
- 必要时重新授权 OAuth

### 问题 3: Crontab 任务不执行
```bash
# 检查 cron 服务
sudo systemctl status cron

# 查看 cron 日志
grep CRON /var/log/syslog | tail -20
```

### 问题 4: 备份脚本失败
- 检查 WebDAV 凭据（见 TOOLS.md）
- 查看备份日志：`/home/ubuntu/.openclaw/workspace/logs/backup_123pan.log`
- 手动测试：`bash /home/ubuntu/.openclaw/workspace/backup.sh`

---

## 📞 恢复失败时怎么办

如果按照上述步骤仍然无法恢复，请：
1. 检查 123 盘是否有更早的备份包
2. 联系主人并提供错误信息
3. 记录问题到 `memory/` 目录，避免下次重复

---

⚡ **让我们继续辅助主人，创造更多价值！**
