# 智谱24/7持续任务调度器

**创建时间**: 2026-02-14
**状态**: ✅ 已部署
**目标**: 让智谱（glm-4.7）24/7不停工作，最大化付费资源利用

---

## 🎯 核心目标

智谱GLM-4.7是**付费模型**（Coding Plan），必须**充分利用**，让它24小时持续工作，直到资源耗尽。

**核心思想**：
- 智谱永远不空闲
- 任务完成后自动领取下一个
- 智能任务优先级排序
- 资源利用率100%

---

## 🚀 快速开始

### 1. 启动调度器（后台运行）

```bash
# 方式1：使用管理脚本（推荐）
bash /home/ubuntu/.openclaw/workspace/scripts/zhipu_scheduler.sh start

# 方式2：直接运行（前台）
python3 /home/ubuntu/.openclaw/workspace/scripts/zhipu_continuous_scheduler.py run
```

### 2. 查看运行状态

```bash
bash /home/ubuntu/.openclaw/workspace/scripts/zhipu_scheduler.sh status
```

### 3. 查看工作统计

```bash
bash /home/ubuntu/.openclaw/workspace/scripts/zhipu_scheduler.sh stats
```

### 4. 实时查看日志

```bash
bash /home/ubuntu/.openclaw/workspace/scripts/zhipu_scheduler.sh log
```

### 5. 停止调度器

```bash
bash /home/ubuntu/.openclaw/workspace/scripts/zhipu_scheduler.sh stop
```

---

## 📋 任务来源

### 自动扫描
调度器会自动扫描 TODO.md，提取所有进行中的项目任务：
- 🔴 第一象限：重要且紧急（最高优先级）
- 🟠 第二象限：紧急但不重要
- 🟡 第三象限：重要但不紧急
- 🟢 第四象限：不重要且不紧急

### 手动添加
```bash
python3 /home/ubuntu/.openclaw/workspace/scripts/zhipu_continuous_scheduler.py add "任务描述"
```

---

## 🏷️ 任务类别

| 类别 | 描述 | 价值评分 |
|-----|------|---------|
| **CODING** | 编码任务（开发、实现） | 60-100 |
| **OPTIMIZATION** | 优化任务（性能、代码） | 70-100 |
| **TESTING** | 测试任务（验证、检查） | 50-80 |
| **REFACTORING** | 重构任务（代码改进） | 60-90 |
| **ANALYSIS** | 分析任务（研究、学习） | 40-70 |
| **DOCUMENTATION** | 文档任务（README、说明） | 30-60 |
| **RESEARCH** | 研究任务（调研、探索） | 20-50 |

---

## 🎯 任务优先级

| 优先级 | 标识 | 来源 |
|--------|------|------|
| **CRITICAL** | 🔴 | 第一象限（重要且紧急） |
| **HIGH** | 🟠 | 第二象限（紧急但不重要） |
| **MEDIUM** | 🟡 | 第三象限（重要但不紧急） |
| **LOW** | 🟢 | 第四象限（不重要且不紧急） |

---

## 📊 工作流程

```
1. 扫描TODO.md → 提取任务
         ↓
2. 排序任务 → 优先级 > 价值评分
         ↓
3. 弹出任务 → 取出最高优先级任务
         ↓
4. 执行任务 → 调用智谱GLM-4.7
         ↓
5. Git提交 → 保存工作成果
         ↓
6. 推送GitHub → 远程备份
         ↓
7. 更新统计 → 记录工作时长
         ↓
8. 返回步骤1 → 继续下一个任务
```

**循环持续，直到资源耗尽或手动停止**

---

## 💡 使用建议

### ✅ 最佳实践
1. **后台启动** - 使用 `zhipu_scheduler.sh start` 后台运行
2. **定期检查** - 使用 `status` 命令查看运行状态
3. **监控日志** - 使用 `log` 命令实时查看工作日志
4. **任务优先级** - 在TODO.md中使用四象限法则管理任务
5. **价值评分** - 重要的任务标记为"🔴"提高优先级

### ⚠️ 注意事项
1. **资源监控** - 确保智谱API额度充足
2. **任务质量** - 避免添加无意义的任务
3. **定期检查** - 每天检查一次工作日志和质量
4. **Git冲突** - 如果代码冲突需要手动解决

---

## 🔧 技术细节

### 任务队列文件
- **位置**: `/home/ubuntu/.openclaw/workspace/.zhipu_task_queue.json`
- **格式**: JSON数组，包含任务对象
- **自动保存**: 每次添加/完成任务后保存

### 工作日志
- **位置**: `/home/ubuntu/.openclaw/workspace/logs/zhipu_continuous_work.jsonl`
- **格式**: JSONL（每行一个JSON对象）
- **内容**: 任务ID、标题、类别、价值评分、状态、消息

### 资源状态
- **位置**: `/home/ubuntu/.openclaw/workspace/.zhipu_resource_state.json`
- **内容**: 完成任务总数、累计工作时长、最后工作时间
- **更新**: 每次完成任务后更新

### 调度器日志
- **位置**: `/home/ubuntu/.openclaw/workspace/logs/zhipu_scheduler.log`
- **内容**: 调度器运行日志（标准输出和错误输出）

---

## 📈 预期效果

### 资源利用率
- **目标**: 100%（智谱持续工作）
- **实际**: 接近100%（仅API调用间隙有微小延迟）

### 工作效率
- **任务完成速度**: 每小时2-4个中等任务（取决于任务复杂度）
- **代码质量**: 每个任务都有Git提交，支持精确回滚
- **GitHub提交**: 自动提交和推送，保持代码同步

### 成本效益
- **付费资源**: 最大化利用（无空闲浪费）
- **代码产出**: 大量高质量代码和文档
- **项目进度**: 快速推进多个项目

---

## 🎉 成果展示

### 统计信息（实时）
```bash
bash /home/ubuntu/.openclaw/workspace/scripts/zhipu_scheduler.sh stats
```

### 最近工作记录
```bash
tail -20 /home/ubuntu/.openclaw/workspace/logs/zhipu_continuous_work.jsonl
```

### Git提交历史
```bash
git log --oneline --since="1 day ago" | grep "feat(zhipu):"
```

---

## 🚀 未来扩展

### 计划功能
- [ ] 多模型支持（同时使用智谱、Kimi、Gemini）
- [ ] 任务依赖关系（某些任务需要其他任务先完成）
- [ ] 动态任务优先级调整（根据历史完成情况）
- [ ] 任务失败重试机制
- [ ] Web监控界面（实时查看工作状态）
- [ ] 飞书通知（任务完成/失败时发送通知）

### 优化方向
- [ ] 更智能的任务价值评分算法
- [ ] 自动生成项目报告
- [ ] 任务并行执行（多个智谱实例）
- [ ] 资源使用预测和优化

---

## 📞 支持

### 问题反馈
编辑本文件或联系管理员

### 日志位置
- 工作日志: `logs/zhipu_continuous_work.jsonl`
- 调度器日志: `logs/zhipu_scheduler.log`
- Git日志: `git log --oneline`

---

**最后更新**: 2026-02-14 18:20
**系统状态**: ✅ 已部署并测试
**资源利用率**: 🎯 100% （智谱持续工作）
**创建者**: 贾维斯 (贾维斯AI助手)
